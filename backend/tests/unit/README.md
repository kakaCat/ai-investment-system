# å•å…ƒæµ‹è¯•

> Serviceã€Converterã€Builderã€Repositoryå±‚å•å…ƒæµ‹è¯•

---

## ğŸš§ çŠ¶æ€

**å½“å‰çŠ¶æ€**: å¾…å¼€å‘

**é¢„è®¡å®Œæˆ**: Phase 2 - æ ¸å¿ƒåŠŸèƒ½å¼€å‘é˜¶æ®µ

---

## ğŸ¯ æµ‹è¯•èŒƒå›´ï¼ˆè§„åˆ’ï¼‰

### 1. Serviceå±‚æµ‹è¯•

æŒ‰ç…§POST-onlyæ¶æ„æµ‹è¯•å„ä¸ªServiceï¼š

- **AccountDetailService** - è´¦æˆ·è¯¦æƒ…æŸ¥è¯¢é€»è¾‘
- **HoldingQueryService** - æŒä»“æŸ¥è¯¢é€»è¾‘
- **TradeRecordService** - äº¤æ˜“è®°å½•é€»è¾‘
- **EventCreateService** - äº‹ä»¶åˆ›å»ºé€»è¾‘
- **AIAnalysisService** - AIåˆ†æé€»è¾‘

### 2. Converterå±‚æµ‹è¯•

æµ‹è¯•æ‰€æœ‰ä¸šåŠ¡é€»è¾‘è®¡ç®—ï¼š

- **æ•°æ®è½¬æ¢** - æ¨¡å‹ â†’ DTOè½¬æ¢
- **è®¡ç®—é€»è¾‘** - æ”¶ç›Šç‡ã€ç›ˆäºã€ç»Ÿè®¡æŒ‡æ ‡
- **æ•°æ®èšåˆ** - å¤šæ•°æ®æºèšåˆ
- **æ ¼å¼åŒ–** - æ—¥æœŸã€é‡‘é¢ã€ç™¾åˆ†æ¯”

### 3. Builderå±‚æµ‹è¯•

æµ‹è¯•å¤æ‚å¯¹è±¡æ„å»ºï¼š

- **å“åº”å¯¹è±¡æ„å»º** - APIå“åº”ç»“æ„
- **åµŒå¥—å¯¹è±¡** - å¤šå±‚çº§æ•°æ®ç»“æ„
- **æ¡ä»¶æ„å»º** - æ ¹æ®å‚æ•°åŠ¨æ€æ„å»º

### 4. Repositoryå±‚æµ‹è¯•

æµ‹è¯•çº¯CRUDæ“ä½œï¼š

- **æŸ¥è¯¢æ–¹æ³•** - get_by_id, query_by_user
- **åˆ›å»ºæ–¹æ³•** - create, bulk_create
- **æ›´æ–°æ–¹æ³•** - update
- **åˆ é™¤æ–¹æ³•** - soft_delete

### 5. å·¥å…·å‡½æ•°æµ‹è¯•

- **æ—¶é—´å¤„ç†** - æ—¶åŒºè½¬æ¢ã€æ ¼å¼åŒ–
- **æ•°å€¼è®¡ç®—** - ç²¾åº¦å¤„ç†ã€å››èˆäº”å…¥
- **å­—ç¬¦ä¸²å¤„ç†** - éªŒè¯ã€æ¸…ç†

---

## ğŸ“ æµ‹è¯•æ¡†æ¶

**è®¡åˆ’ä½¿ç”¨**:
- `pytest` - æµ‹è¯•æ¡†æ¶
- `pytest-asyncio` - å¼‚æ­¥æµ‹è¯•
- `pytest-cov` - è¦†ç›–ç‡æŠ¥å‘Š
- `pytest-mock` - Mockå¯¹è±¡
- `freezegun` - æ—¶é—´å†»ç»“

---

## ğŸ¯ è¦†ç›–ç‡ç›®æ ‡

- **Serviceå±‚**: â‰¥ 90%
- **Converterå±‚**: â‰¥ 95%
- **Builderå±‚**: â‰¥ 95%
- **Repositoryå±‚**: â‰¥ 80%
- **å·¥å…·å‡½æ•°**: 100%

---

## ğŸ”— ç›¸å…³æ–‡æ¡£

- [åç«¯æ¶æ„](../../docs/design/architecture/backend-architecture.md)
- [Serviceæ¨¡å¼è¯´æ˜](../../docs/design/architecture/backend-architecture.md#service-layer-structure)
- [ä»£ç è§„èŒƒ](../../docs/guides/development/)

---

**æœ€åæ›´æ–°**: 2025-11-19
