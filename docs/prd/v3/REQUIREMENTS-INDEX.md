# PRD v3.1 需求编号索引

> 需求编号规范与完整索引

## 需求编号规范

### 命名格式

```
R-<模块缩写>-<序号>
```

- **R**: Requirement（需求）
- **模块缩写**: 3个字母的模块标识（大写）
- **序号**: 3位数字，从001开始

### 优先级标识

在需求描述中使用以下标识：
- **P0**: MVP 必需（第一版必须实现）
- **P1**: 重要功能（第二版实现）
- **P2**: 优化功能（后续版本）

---

## 模块缩写对照表

| 模块缩写 | 模块名称 | PRD 章节 | 需求数量 |
|---------|---------|---------|---------|
| **USR** | 用户与认证 | 2.1 | 6 |
| **ACC** | 账户管理 | 2.2 | 10 |
| **STK** | 股票信息库 | 2.3 | 7 ⬆️ |
| **HLD** | 持仓管理 | 2.4 | 13 ⬆️ |
| **TRD** | 交易记录 | 2.5 | 6 |
| **AIA** | AI 策略生成 | 2.6 | 12 |
| **STR** | 策略记录与复盘 | 2.7 | 8 |
| **PRC** | 价格管理 | 2.8 | 15 ⬆️ |
| **EVT** | 事件分析系统 | 2.9 | 15 |
| **VIS** | 数据可视化 | 2.10 | 6 |
| **API** | API 接口 | 4 | 50+ |

**总需求数**: 93+ (不含API接口)

---

## 需求编号完整索引

### 2.1 用户与认证（USR）

| 需求编号 | 需求名称 | 优先级 | 状态 | 说明 |
|---------|---------|--------|------|------|
| R-USR-001 | 用户注册 | P0 | 待实施 | 邮箱/密码注册，密码强度校验 |
| R-USR-002 | 用户登录 | P0 | 待实施 | JWT Token 认证机制 |
| R-USR-003 | 密码重置 | P1 | 待实施 | 邮件验证码重置密码 |
| R-USR-004 | Token 刷新 | P0 | 待实施 | Access Token + Refresh Token 机制 |
| R-USR-005 | 用户信息管理 | P1 | 待实施 | 修改昵称、邮箱、密码 |
| R-USR-006 | AI Token 管理 | P0 | 待实施 | 购买、消耗、余额查询 |

### 2.2 账户管理（ACC）

| 需求编号 | 需求名称 | 优先级 | 状态 | 说明 |
|---------|---------|--------|------|------|
| R-ACC-001 | 创建账户 | P0 | 待实施 | 支持多账户，指定券商、市场 |
| R-ACC-002 | 编辑账户 | P0 | 待实施 | 修改账户名称、费用配置 |
| R-ACC-003 | 删除账户 | P1 | 待实施 | 软删除，保留历史数据 |
| R-ACC-004 | 账户列表 | P0 | 待实施 | 显示所有账户，支持筛选排序 |
| R-ACC-005 | 账户详情 | P0 | 待实施 | 双列表展示（持仓+关注）、Tab导航、资金明细 |
| R-ACC-006 | 资金管理 | P0 | 待实施 | 充值、转账、费用配置 |
| R-ACC-007 | 绩效分析 | P1 | 待实施 | 收益曲线、风险指标、交易统计 |
| R-ACC-008 | 多市场支持 | P0 | 待实施 | A股/港股/美股 |
| R-ACC-009 | 费用配置 | P0 | 待实施 | 佣金、印花税、过户费 |
| R-ACC-010 | 数据导出 | P2 | 待实施 | 导出持仓、交易记录、绩效报告 |

### 2.3 股票信息库（STK）

| 需求编号 | 需求名称 | 优先级 | 状态 | 说明 |
|---------|---------|--------|------|------|
| R-STK-001 | 股票搜索 | P0 | 待实施 | 按代码/名称/拼音搜索，支持模糊匹配 |
| R-STK-002 | 股票详情 | P0 | 待实施 | 基本信息、交易规则、公司信息 |
| R-STK-003 | 多市场支持 | P0 | 待实施 | A股/港股/美股不同规则（lot_size、涨跌幅） |
| R-STK-004 | 行业筛选 | P1 | 待实施 | 按行业分类浏览股票 |
| R-STK-005 | 自动获取信息 | P0 | 待实施 | 添加股票时通过MCP自动获取并缓存基本信息 |
| R-STK-006 | 本地缓存 | P0 | 待实施 | stocks表缓存股票信息，有效期30天 |
| R-STK-007 | 公司基本面 | P1 | 待实施 | 通过MCP获取财务指标（PE/ROE/负债率） |

### 2.4 持仓管理（HLD）

| 需求编号 | 需求名称 | 优先级 | 状态 | 说明 |
|---------|---------|--------|------|------|
| R-HLD-001 | 创建持仓 | P0 | 待实施 | 手动添加/导入持仓 |
| R-HLD-002 | 更新持仓 | P0 | 待实施 | 修改成本价、数量 |
| R-HLD-003 | 删除持仓 | P0 | 待实施 | 软删除，保留历史 |
| R-HLD-004 | 持仓列表 | P0 | 待实施 | 支持筛选、排序 |
| R-HLD-005 | 盈亏计算 | P0 | 待实施 | 实时计算浮动盈亏 |
| R-HLD-006 | 成本价计算 | P0 | 待实施 | 支持多次买入的平均成本 |
| R-HLD-007 | 标签管理 | P1 | 待实施 | 用户自定义/AI标签 |
| R-HLD-008 | 持仓导入 | P1 | 待实施 | CSV/Excel批量导入 |
| R-HLD-009 | 关注列表管理 | P0 | 待实施 | 添加/移除关注股票，设置目标价 |
| R-HLD-010 | 关注度评级 | P0 | 待实施 | 用户评级（⭐-⭐⭐⭐）对应Low-Medium-High |
| R-HLD-011 | 关注列表排序 | P0 | 待实施 | 按关注度、价格偏离度、AI建议排序 |
| R-HLD-012 | 关注转持仓 | P0 | 待实施 | 建仓后自动移至持仓列表 |
| R-HLD-013 | 持仓转关注 | P1 | 待实施 | 清仓后提示是否继续关注 |

### 2.5 交易记录（TRD）

| 需求编号 | 需求名称 | 优先级 | 状态 | 说明 |
|---------|---------|--------|------|------|
| R-TRD-001 | 记录交易 | P0 | 待实施 | 买入/卖出/分红 |
| R-TRD-002 | 费用计算 | P0 | 待实施 | 自动计算佣金、税费 |
| R-TRD-003 | 交易列表 | P0 | 待实施 | 支持筛选、排序 |
| R-TRD-004 | 已实现盈亏 | P0 | 待实施 | 卖出时计算盈亏 |
| R-TRD-005 | 幂等性保证 | P0 | 待实施 | 使用 idempotency_key 防重 |
| R-TRD-006 | 交易导入 | P1 | 待实施 | 从券商账单导入 |

### 2.6 AI 策略生成（AIA）

| 需求编号 | 需求名称 | 优先级 | 状态 | 说明 |
|---------|---------|--------|------|------|
| R-AIA-001 | 整体持仓分析 | P0 | 待实施 | 账户级 AI 分析 |
| R-AIA-002 | 单股深度分析 | P0 | 待实施 | 个股详细分析 |
| R-AIA-003 | 投资机会发现 | P1 | 待实施 | 基于市场扫描 |
| R-AIA-004 | 操作建议生成 | P0 | 待实施 | 买入/卖出/持有建议 |
| R-AIA-005 | 风险评估 | P0 | 待实施 | 持仓风险分析 |
| R-AIA-006 | Token 消耗追踪 | P0 | 待实施 | 记录每次分析消耗 |
| R-AIA-007 | 分析历史记录 | P1 | 待实施 | 查看历史分析 |
| R-AIA-008 | 分析结果缓存 | P1 | 待实施 | 避免重复分析 |
| R-AIA-009 | 批量分析 | P1 | 待实施 | 多股票批量分析 |
| R-AIA-010 | 自定义分析参数 | P2 | 待实施 | 用户调整分析维度 |
| R-AIA-011 | AI模型选择 | P2 | 待实施 | 支持多 AI 提供商 |
| R-AIA-012 | 分析报告导出 | P2 | 待实施 | PDF/Markdown 导出 |

### 2.7 策略记录与复盘（STR）

| 需求编号 | 需求名称 | 优先级 | 状态 | 说明 |
|---------|---------|--------|------|------|
| R-STR-001 | 策略自动保存 | P0 | 待实施 | AI分析结果自动保存 |
| R-STR-002 | 策略列表查看 | P0 | 待实施 | 支持筛选、排序 |
| R-STR-003 | 策略执行标记 | P0 | 待实施 | 标记是否执行 |
| R-STR-004 | 策略评估 | P1 | 待实施 | 计算准确率、盈亏 |
| R-STR-005 | 复盘看板 | P1 | 待实施 | 可视化策略表现 |
| R-STR-006 | 执行率统计 | P1 | 待实施 | 统计执行情况 |
| R-STR-007 | 准确率统计 | P1 | 待实施 | 统计预测准确率 |
| R-STR-008 | 资金利用率 | P1 | 待实施 | 统计资金使用效率 |

### 2.8 价格管理（PRC）

| 需求编号 | 需求名称 | 优先级 | 状态 | 说明 |
|---------|---------|--------|------|------|
| R-PRC-001 | 手动刷新价格 | P0 | 待实施 | 单个/批量/按账户刷新，单次最多50只 |
| R-PRC-002 | MCP 数据集成 | P0 | 待实施 | Tushare Pro（主）+ AkShare（备），自动降级 |
| R-PRC-003 | 新浪财经API | P0 | 待实施 | 直接调用新浪接口，免费稳定，实时性好 |
| R-PRC-004 | 雪球API | P1 | 待实施 | 直接调用雪球接口，支持A/港/美股 |
| R-PRC-005 | 东方财富API | P1 | 待实施 | 备选数据源，直接调用 |
| R-PRC-006 | 数据源降级策略 | P0 | 待实施 | 5级降级：Tushare→新浪→雪球→AkShare→东方财富 |
| R-PRC-007 | 价格快照存储 | P0 | 待实施 | 保存到price_snapshots表，记录source来源 |
| R-PRC-008 | 数据缓存策略 | P0 | 待实施 | 交易时间30s，非交易5min缓存 |
| R-PRC-009 | API频率控制 | P0 | 待实施 | Tushare限200次/分钟，新浪单次100只 |
| R-PRC-010 | MCP配置管理 | P0 | 待实施 | Tushare Token、AkShare配置 |
| R-PRC-011 | 股票代码转换 | P0 | 待实施 | 统一格式转换各平台代码（sh/sz前缀等） |
| R-PRC-012 | 多源数据验证 | P1 | 待实施 | 可选：并行调用多源，取中位数验证 |
| R-PRC-013 | 价格提醒 | P1 | 待实施 | 目标价/止损位/涨跌幅提醒 |
| R-PRC-014 | 历史数据获取 | P1 | 待实施 | 日线级别历史数据，用于技术指标 |
| R-PRC-015 | 实时行情推送 | P2 | 待实施 | WebSocket 推送（可选） |

### 2.9 事件分析系统（EVT）⭐

| 需求编号 | 需求名称 | 优先级 | 状态 | 说明 |
|---------|---------|--------|------|------|
| R-EVT-001 | 手动记录事件 | P0 | 待实施 | 4大类16子类事件 |
| R-EVT-002 | 事件基本信息 | P0 | 待实施 | 标题、时间、重要性、影响 |
| R-EVT-003 | 事件批量导入 | P1 | 待实施 | CSV 导入 |
| R-EVT-004 | 事件自动采集 | P1 | 待实施 | MCP 新闻API集成 |
| R-EVT-005 | 事件去重 | P1 | 待实施 | 相似度检测 |
| R-EVT-006 | 事件时间线 | P0 | 待实施 | 全局/股票级/账户级 |
| R-EVT-007 | 事件筛选 | P0 | 待实施 | 按类型/重要性/时间 |
| R-EVT-008 | AI 单事件分析 | P0 | 待实施 | 影响评估、置信度 |
| R-EVT-009 | AI 批量事件分析 | P1 | 待实施 | 综合影响分析 |
| R-EVT-010 | 事件影响矩阵 | P0 | 待实施 | 事件×持仓影响表 |
| R-EVT-011 | 事件提醒 | P1 | 待实施 | Critical立即推送 |
| R-EVT-012 | 事件日历 | P1 | 待实施 | 重要事件日期 |
| R-EVT-013 | 定时事件收集 | P1 | 待实施 | 每小时采集 |
| R-EVT-014 | 定时影响分析 | P1 | 待实施 | 异步分析任务 |
| R-EVT-015 | 事件与持仓关联 | P0 | 待实施 | 关联分析 |

### 2.10 数据可视化（VIS）

| 需求编号 | 需求名称 | 优先级 | 状态 | 说明 |
|---------|---------|--------|------|------|
| R-VIS-001 | Dashboard 仪表板 | P0 | 待实施 | 账户概览、AI提醒 |
| R-VIS-002 | 持仓图表 | P0 | 待实施 | 饼图、柱状图 |
| R-VIS-003 | 绩效曲线 | P1 | 待实施 | 净值走势图 |
| R-VIS-004 | 事件时间轴 | P0 | 待实施 | 可视化事件 |
| R-VIS-005 | 策略复盘看板 | P1 | 待实施 | 策略表现可视化 |
| R-VIS-006 | 响应式设计 | P0 | 待实施 | 移动端适配 |

---

## 需求统计

| 模块 | P0 需求数 | P1 需求数 | P2 需求数 | 总计 |
|------|---------|---------|---------|------|
| 用户与认证 | 3 | 2 | 1 | 6 |
| 账户管理 | 6 | 3 | 1 | 10 |
| 股票信息库 | 3 | 2 | 0 | 5 |
| 持仓管理 | 6 | 2 | 0 | 8 |
| 交易记录 | 5 | 1 | 0 | 6 |
| AI 策略生成 | 5 | 4 | 3 | 12 |
| 策略记录与复盘 | 3 | 5 | 0 | 8 |
| 价格管理 | 3 | 0 | 1 | 4 |
| **事件分析系统** | **7** | **8** | **0** | **15** |
| 数据可视化 | 4 | 2 | 0 | 6 |
| **总计** | **45** | **29** | **6** | **80** |

### MVP 范围（P0）
总计 **45 个核心需求**，预计开发周期 **10-12 周**

---

## 需求优先级定义

### P0 - MVP 必需
- 第一版必须实现
- 影响核心功能可用性
- 用户无法绕过的功能
- 预计 Phase 1-7 完成（10周）

### P1 - 重要功能
- 第二版实现
- 显著提升用户体验
- 有替代方案但体验较差
- 预计 Phase 8-10 完成（6周）

### P2 - 优化功能
- 后续版本实现
- 锦上添花的功能
- 用户可以接受暂时没有
- 根据用户反馈决定是否实现

---

## 相关文档

- **PRD 拆分章节**: [sections/](sections/)
- **原型设计**: [../../design/ui/wireframes/](../../design/ui/wireframes/)（原型图中已引用部分需求编号）
- **数据库设计**: [../../design/database/schema-v1.md](../../design/database/schema-v1.md)

---

**创建日期**: 2025-01-15
**维护者**: Claude Code
**用途**: 需求追踪、测试覆盖、进度管理
